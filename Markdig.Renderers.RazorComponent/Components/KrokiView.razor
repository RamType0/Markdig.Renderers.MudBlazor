@using global::Kroki
@using System.IO.Compression
@inject KrokiClient KrokiClient

<img src="@imageSrc" diagram-type="@DiagramType" alt="@DiagramSource"/>

@code {
    [Parameter, EditorRequired]
    public required string DiagramType { get; set; }
    [Parameter, EditorRequired]
    public required string DiagramSource { get; set; }

    string imageSrc = "";

    protected override void OnParametersSet()
    {
        imageSrc = KrokiClient.CreateGetUri(new()
            {
                DiagramType = DiagramType,
                OutputFormat = FileFormat.Svg,
                DiagramSource = DiagramSource
            }, CompressionLevel.Optimal).AbsoluteUri;
    }
}
