@using Markdig.Extensions.Mathematics
@using Microsoft.JSInterop
@inject IJSRuntime JsRuntime

@if(!renderingMathInline)
{
    @markupString
}

@code {
    [Parameter, EditorRequired]
    public required MathInline MathInline { get; set; }

    MarkupString markupString = new("");

    bool renderingMathInline;

    static readonly object katexOptions = new { throwOnError = false };

    protected override async Task OnParametersSetAsync()
    {
        renderingMathInline = true;
        var html = await JsRuntime.InvokeAsync<string>("katex.renderToString", MathInline.Content.ToString(), katexOptions);
        renderingMathInline = false;
        markupString = new(html);
    }
}
